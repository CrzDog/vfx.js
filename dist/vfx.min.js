var vfx=function(t,i){"use strict";class e{constructor(){this._emitters=[]}setCamPos(t){for(let i=0;i<this._emitters.length;++i){let e=this._emitters[i];e._camPos=t}}start(){for(let t=0;t<this._emitters.length;++t){let i=this._emitters[t];if(!i.disabled){i.tick()}}}tick(t){for(let i=0;i<this._emitters.length;++i){let e=this._emitters[i];if(!e.disabled){e.tick(t)}}}addEmitter(t){if(this._emitters.indexOf(t)===-1){this._emitters.push(t)}}removeEmitter(t){let i=this._emitters.indexOf(t);if(i!==-1){this._emitters.splice(i,1)}}}class s{constructor(){this.life=1;this.velocity=t.vec3.new(0,1,0);this.age=0;this.position=t.vec3.new(0,0,0);this._distanceToCam=1}reset(){this.age=0;t.vec3.set(this.position,0,0,0);this._distanceToCam=1}}class n{constructor(){this.emitRate=10;this.maxParticles=0;this.disabled=true;this.age=0;this.emittedCount=0;this._nextEmits=0;this._particles=new i.RecyclePool(function(){return new s},100);this._camPos=null}start(){if(!this.disabled){return}this.disabled=false}stop(){if(this.disabled){return}this.age=0;this.disabled=true}tick(i){if(this.disabled){return}this.age+=i;for(let e=0;e<this._particles.length;++e){let s=this._particles.data[e];s.age+=i;if(s.age>=s.life){s.reset();this._particles.remove(e);--e;continue}t.vec3.scaleAndAdd(s.position,s.position,s.velocity,i);if(this._camPos){s._distanceToCam=-t.vec3.squaredDistance(s.position,this._camPos)}}this._nextEmits+=this.emitRate*i;if(this._nextEmits>=1){let i=Math.floor(this._nextEmits);this._nextEmits-=i;while(i>0){let e=this._particles.add();this.emittedCount+=1;t.vec3.random(e.velocity,t.randomRange(.1,10));e.life=t.randomRange(1,10);if(this._camPos){e._distanceToCam=-t.vec3.squaredDistance(e.position,this._camPos)}--i}}if(this._camPos){this._particles.sort((t,i)=>{return t._distanceToCam-i._distanceToCam})}}}var a={Effect:e,Emitter:n};return a}(window.vmath,window.memop);
//# sourceMappingURL=vfx.min.js.map